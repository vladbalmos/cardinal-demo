import{g as e}from"./p-9835b40a.js";import{c as n}from"./p-3ebe5698.js";function t(e){let n=this;Object.keys(e).forEach((function(t){n[t]=e[t]}))}function l(n,t,l,o){let r=this;const i=e(r);return Array.from(i.attributes).filter(e=>e.name.startsWith(l)).forEach(e=>{const o=e.name.split(l)[1];r[o]=t.getChainValue(n?`${n}.${e.value}`:e.value)}),o()}function o(n,t,l,o){let r=this;const i=e(r);return Array.from(i.attributes).filter(e=>e.value.startsWith(l)).forEach(e=>{const o=e.value.split(l)[1],i=n?`${n}.${o}`:o;r[e.name]=t.getChainValue(i),t.onChange(i,(function(){r[e.name]=t.getChainValue(i)}))}),o()}function r(e,n){try{let t=this;if(t.rootModel){let l=e;return t.parentChain&&(l=`${t.parentChain}.${e}`),t.rootModel.setChainValue(l,n),!0}return!1}catch(t){console.error(t)}return!1}function i(n,t,r){if(n||!t)return r();let i,u,a,c=this,f=e(c);if(null!==f.getAttribute("data-view-model")&&"psk-for-each"===f.tagName.toLowerCase())return i=f.getAttribute("data-view-model"),c.__assignProperties.call(c,{rootModel:t,parentChain:a=i}),r();if(i=f.getAttribute("view-model"),a=i,null===i&&(null!==(u=null===f.getAttribute("name")||f.getAttribute("name").startsWith("@")?null:f.getAttribute("name"))||null===f.getAttribute("label")||f.getAttribute("label").startsWith("@")||(u=f.getAttribute("label").replace(/( |:|\/|\.|-)/g,"").toLowerCase()),a=u),!i&&!u)return o.call(c,a,t,"@",r),l.call(c,a,t,"view-model-",r),r();function s(e,n){c[e]=t.getChainValue(n),t.onChange(n,(function(){c[e]=t.getChainValue(n)}))}if(c.__assignProperties.call(c,{rootModel:t,parentChain:a}),i){let e=t.getChainValue(a);return e?(Object.keys(e).forEach(e=>{s(e,`${a}.${e}`)}),function(){const e=`${a}.value`;if(!t.getChainValue(a)||t.getChainValue(e))return r();s("value",e)}(),r()):r()}return r()}function u(){return l=>{let{componentWillLoad:o,render:u}=l;l.componentWillLoad=function(){let l=this,a=e(l);return l.render=u,l.changeModel=r,l.__assignProperties=t,a.isConnected?0===a.getAttributeNames().filter(e=>"data-view-model"===e.toLowerCase()||!!e.toLowerCase().includes("view-model")||!!a.getAttribute(e).toLowerCase().startsWith("@")).length?o&&o.call(l):new Promise(e=>{!function(e){n("getModelEvent",{bubbles:!0,composed:!0,cancellable:!0,detail:{callback:function(n,t){i.apply(l,[n,t,e])}}},!0,a)}(()=>{e(o&&o.call(l))})}):o&&o.call(l)}}}export{u as B};